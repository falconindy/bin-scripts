#!/bin/bash

#
# This is intended to be a hook from a WM to notify-osd. There's not much sense
# in calling this directly. Relies on ossmix.
#
# Example dwm usage:
# static const char *volup[]     = { "volOSD",   "pcm2",  "+5" };
# static const char *voldown[]   = { "volOSD",   "pcm2",  "-5" };
#

mixer=$1
increment=$2

display_volume=$(sed -n 's/.*:\([0-9\.]*\)$/\1/p' <(ossmix $mixer -- $increment))
display_volume=${display_volume%%.*} # truncate decimal if any

icon_name="notification-audio-volume-"

if [[ $display_volume -gt 67 ]]; then
  icon_name+="high"
elif [[ $display_volume -gt 33 ]]; then 
  icon_name+="medium"
elif [[ $display_volume -gt 0 ]]; then 
  icon_name+="low"
else
  icon_name+="muted"
fi

notify-send " " -i $icon_name -h int:value:$display_volume -h string:synchronous:volume -t 1000
